id: doa_power_detection_cpp
label: Power Detection (C++)
category: '[doa]'

templates:
  imports: from gnuradio import doa
  make: doa.power_detection_cpp(${num_inputs}, ${sample_rate}, ${threshold}, ${buffer_size})

parameters:
- id: num_inputs
  label: Number of Inputs
  dtype: int
  default: 2
  hide: part

- id: sample_rate
  label: Sample Rate
  dtype: real
  default: samp_rate

- id: threshold
  label: Power Threshold
  dtype: real
  default: 0.01

- id: buffer_size
  label: Buffer Size
  dtype: int
  default: 1024
  hide: part

inputs:
- domain: stream
  dtype: complex
  multiplicity: ${num_inputs}

outputs:
- domain: stream
  dtype: complex
  multiplicity: ${num_inputs}

documentation: |-
  Power Detection Block (C++ optimized)
  
  Detects signal power on the first input channel. When power exceeds the threshold,
  captures the signal to an internal buffer. During silence periods, replays the
  captured signal on all channels.
  
  Parameters:
    - Number of Inputs: Number of input/output channels
    - Sample Rate: Sample rate in Hz
    - Power Threshold: Power level (|sample|^2) above which signal is detected
    - Buffer Size: Size of capture/playback buffer in samples

file_format: 1
